"use strict";(()=>{var ye=Object.create;var ne=Object.defineProperty;var pe=Object.getOwnPropertyDescriptor;var ge=Object.getOwnPropertyNames;var he=Object.getPrototypeOf,fe=Object.prototype.hasOwnProperty;var Ee=(o=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(o,{get:(e,t)=>(typeof require!="undefined"?require:e)[t]}):o)(function(o){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+o+'" is not supported')});var Le=(o,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of ge(e))!fe.call(o,n)&&n!==t&&ne(o,n,{get:()=>e[n],enumerable:!(r=pe(e,n))||r.enumerable});return o};var ve=(o,e,t)=>(t=o!=null?ye(he(o)):{},Le(e||!o||!o.__esModule?ne(t,"default",{value:o,enumerable:!0}):t,o));var Se,be=import("https://openfpcdn.io/fingerprintjs/v3").then(o=>o.load()),F=async()=>{Se=await be.then(o=>o.get()).then(o=>o.visitorId)};var w=class{constructor(e,t){this.apiUrl=e,this.bearerToken=t}async get(e){let t=`${this.apiUrl}/${e}`;try{let r=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.bearerToken}`}});return await this.handleResponse(r)}catch(r){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0438 GET-\u0437\u0430\u043F\u0440\u043E\u0441\u0430:",r),r}}async post(e,t){let r=`${this.apiUrl}/${e}`;try{let n=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.bearerToken}`},body:JSON.stringify(t)});return await this.handleResponse(n)}catch(n){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0438 POST-\u0437\u0430\u043F\u0440\u043E\u0441\u0430:",n),n}}async postBinary(e,t){let r=`${this.apiUrl}/${e}`;try{let n=await fetch(r,{method:"POST",headers:{Accept:"application/json",Authorization:`Bearer ${this.bearerToken}`},body:t});return await this.handleResponse(n)}catch(n){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0438 POST-\u0437\u0430\u043F\u0440\u043E\u0441\u0430:",n),n}}async delete(e){let t=`${this.apiUrl}/${e}`;try{let r=await fetch(t,{method:"DELETE",headers:{accept:"*/*",Authorization:`Bearer ${this.bearerToken}`}});await this.handleResponse(r)}catch(r){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0438 DELETE-\u0437\u0430\u043F\u0440\u043E\u0441\u0430:",r),r}}async patch(e,t){let r=`${this.apiUrl}/${e}`;try{let n=await fetch(r,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.bearerToken}`},body:JSON.stringify(t)});return await this.handleResponse(n)}catch(n){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0438 PATCH-\u0437\u0430\u043F\u0440\u043E\u0441\u0430:",n),n}}async handleResponse(e){if(!e.ok){let t=await e.json();throw{status:e.status,message:t}}if(e.status!==204)return await e.json()}};var l=class{constructor(){let e=i.getToken(),t="https://atrium-prod-api.optic.xyz/aion/users";this.client=new w(t,e)}static getInstance(){return l.instance||(l.instance=new l),l.instance}static async fetchRequests(e=0,t=10){try{let r=l.getInstance().client,n=`data?filters=requests&offset=${e}&limit=${t}`;return await r.get(n).then(a=>a.requests.array)}catch(r){return console.error("\u041E\u0448\u0438\u0431\u043A\u0430 getRequests:",r),[]}}static async fetchUsageApi(){try{let e=l.getInstance().client,t="data?filters=api&offset=0&limit=10";return await e.get(t).then(r=>r.api)}catch(e){return console.error("\u041E\u0448\u0438\u0431\u043A\u0430 fetchUsageApi:",e),[]}}static async signUp(){try{return await l.getInstance().client.post("sign_up",{}).then(()=>!1).catch(t=>{if(t.status===400)return!0;throw t})}catch(e){return console.error("\u041E\u0448\u0438\u0431\u043A\u0430 signUp:",e),!1}}static async login(){try{return await l.getInstance().client.get("login")}catch(e){console.error("\u041E\u0448\u0438\u0431\u043A\u0430 login:",e)}}static async delete(){try{return await l.getInstance().client.delete("")}catch(e){console.error("\u041E\u0448\u0438\u0431\u043A\u0430 delete:",e)}}static async fetchApiToken(){try{return await l.getInstance().client.post("api_token",{})}catch(e){console.error("\u041E\u0448\u0438\u0431\u043A\u0430 fetchApiToken:",e)}}static async refreshApiToken(){try{return await l.getInstance().client.patch("api_token",{})}catch(e){console.error("\u041E\u0448\u0438\u0431\u043A\u0430 refreshApiToken:",e)}}},S=l;S.instance=null;var f=class{constructor(){}static isAuth(){return localStorage.getItem(f.key)!==null}static setAuth(){localStorage.setItem(f.key,"true")}static removeAuth(){localStorage.removeItem(f.key)}static async init(){f.isAuth()?await S.login():(await S.signUp(),f.setAuth(),await S.login())}static getToken(){var e;return(e=localStorage.getItem("_ms-mid"))!=null?e:""}static isExpiredToken(){let e=f.getToken();try{let[t,r,n]=e.split("."),a=JSON.parse(atob(r)),g=Math.floor(Date.now()/1e3);return a.exp<g}catch(t){return console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u043F\u0440\u043E\u0432\u0435\u0440\u043A\u0435 \u0442\u043E\u043A\u0435\u043D\u0430:",t),!1}}},i=f;i.key="isSignUp";var E=class{constructor(){let e=i.getToken(),t="https://atrium-prod-api.optic.xyz/aion/ai-generated";this.client=new w(t,e)}static getInstance(){return E.instance||(E.instance=new E),E.instance}static async getReportsByBinary(e){let t=E.getInstance().client;try{let r=new FormData;return r.append("binary",e,"uploaded-file.png"),await t.postBinary("reports/binary",r)}catch(r){console.error("Error getReportsByBinary:",r)}}static async getReportsByUrl(e){let t=E.getInstance().client;try{let r=`reports/url?url=${e}`;return await t.post(r,{})}catch(r){console.error("\u041E\u0448\u0438\u0431\u043A\u0430 getReportsByUrl:",r)}}},_=E;_.instance=null;var b=class{constructor(){}static async getReportsByBinary(e,t){let r=`https://atrium-prod-api.optic.xyz/results/api/detector/reports/raw?source=web&user_id=${t}`,n=new FormData;n.append("binary",e,"file_name.png");let a={method:"POST",headers:{Accept:"application/json",Authorization:`Bearer ${i.getToken()}`},body:n};return await fetch(r,a).then(g=>g.json())}static async getReportsByUrl(e,t){let r=`https://atrium-prod-api.optic.xyz/results/api/detector/reports/json?source=web&user_id=${t}`,n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${i.getToken()}`},body:JSON.stringify({object:e})};return await fetch(r,n).then(a=>a.json())}static async sendFeedback(e,t,r){let n={is_proper_predict:t,comment:r},a=`https://atrium-prod-api.optic.xyz/results/api/detector/reports/result/${e}`,g={method:"PUT",body:JSON.stringify(n),headers:{Accept:"application/json","Content-Type":"application/json"}};i.isExpiredToken()||(a=`https://atrium-prod-api.optic.xyz/aion/ai-generated/reports/${e}`,g={method:"PATCH",body:JSON.stringify(n),headers:{Accept:"application/json","Content-Type":"application/json"}}),await fetch(a,g).then(m=>m.json()).then(m=>console.log(m)).catch(m=>console.error(m))}static async getAudioVerdict(e){let t="https://v3-atrium-stage-api.optic.xyz/aion/ai-generated/reports/audio/binary",r=new FormData;r.append("binary",e);let n={method:"POST",headers:{Accept:"application/json",Authorization:`Bearer ${i.getToken()}`},body:r};return await fetch(t,n).then(a=>a.json())}};var k=class{constructor(){}static isLimitExceeded(){if(!i.isExpiredToken())return!1;let e=localStorage.getItem(k.key);return e===null?!1:parseInt(e)>5}static increment(){let e=localStorage.getItem(k.key),t=e===null?1:Number(e)+1;localStorage.setItem(k.key,t.toString())}},p=k;p.key="requestCount";var L=class{static async getReportsByBinary(e,t){return i.isExpiredToken()?await b.getReportsByBinary(e,t):await _.getReportsByBinary(e)}static async getReportsByUrl(e,t){return i.isExpiredToken()?await b.getReportsByUrl(e,t):await _.getReportsByUrl(e)}static async sendFeedback(e,t,r){return await b.sendFeedback(e,t,r)}};var oe=()=>{var te,se;let o=document.getElementById("report-screen"),e=document.querySelector("#button-report-submit"),t=document.querySelector("#input-report-comment"),r=document.querySelector("#button-report_true"),n=document.querySelector("#button-report_false"),a=document.querySelector("#button-report_close"),g=document.querySelectorAll(".test-image"),m=document.querySelector("#url-error-message"),U=document.querySelector("#processing_cancel"),d=document.querySelector("#file-input"),x=document.querySelector("#ai-or-not-current-image"),C=document.querySelector("#empty-preview-img"),R=document.querySelector("#nsfw-preview-img"),P=document.querySelector("#input-error-text"),I=document.querySelector("#ai-or-not_image-url"),M=document.querySelector("#ai-or-not_submit"),D=document.querySelector("#ai-or-not_dropzone"),h=document.querySelector("#ai-or-not_dropzone-text"),H=document.querySelector("#result-screen_col"),O=document.querySelector("#share-items-hide"),ie=document.querySelector("#ai-or-not-dropzone-counter"),B=document.querySelector("#ai-or-not-dropzone-counter-w"),A,W,q,$,N;(()=>{if(!i.isExpiredToken())B==null||B.classList.add("hide");else{let s=localStorage.getItem("requestCount")||"0";ie.textContent=Number(s)<=5?s:"5",B.classList.remove("hide")}})(),F();let ae=()=>{let s=document.querySelector("#button-report_false-text");s.classList.remove("hide"),s.textContent=s.getAttribute("report-button-text-default_reported"),n.classList.add("is-reported"),r.classList.add("hide")},ce=()=>{let s=document.querySelector("#button-report_true-text");s.classList.remove("hide"),s.textContent=s.getAttribute("report-button-text-default_reported"),r.classList.add("is-reported"),n.classList.add("hide")},le=()=>{t.value="";let s=document.querySelector("#button-report_true-text"),c=document.querySelector("#button-report_false-text");c.classList.add("hide"),s.classList.remove("hide"),s.textContent=s.getAttribute("report-button-text-default"),c.textContent=c.getAttribute("report-button-text-default"),r.classList.remove("is-reported"),n.classList.remove("is-reported"),r.classList.remove("hide"),n.classList.remove("hide")},Z=s=>{$=s;let c=!localStorage.getItem("_ms-mid"),v=document.querySelector('[fs-socialshare-element="url"]'),re=`${i.isExpiredToken()?"https://results.aiornot.com/aiornot/":"https://results.aiornot.com/aiornot/users/"}${s}`;v.textContent=re,document.querySelectorAll(".result-screen_share-item").forEach(ue=>{ue.setAttribute("data-url",re)})},G=()=>{h.textContent="We support jpeg, png, webp, gif, tiff, bmp. 10 Mb of maximum size.",h.classList.remove("text-color-red"),P.textContent="Something went wrong. Try again.",m.classList.add("hide")},J=()=>{m.classList.remove("hide")},de=()=>{m.classList.add("hide")},z=()=>{H.classList.contains("hide")?(h.textContent="File is too large (max 10 MB)",h.classList.add("text-color-red")):(P.textContent="File is too large (max 10 MB)",m.classList.remove("hide"))};d==null||d.addEventListener("change",()=>{let s=d==null?void 0:d.files[0].size,c=10*1024*1024;s>c?(q=!1,z()):(q=!0,G())});let me=()=>{document.querySelector("#processing-screen").classList.add("hide"),h.classList.add("error"),D.classList.add("red-border"),h.textContent="Something went wrong. Try again."},V=()=>{h.classList.remove("error"),D.classList.remove("red-border"),h.textContent="We support jpeg, png, webp, gif, tiff, bmp. 10 Mb of maximum size."},T=()=>{document.querySelector("#choose-file-row").classList.add("hide"),document.querySelector("#legal-tip").classList.remove("hide"),document.querySelector("#processing-screen").classList.add("hide"),document.querySelector("#hero-home_title-description").classList.remove("hide"),document.querySelector("#hero-home_gallery").classList.remove("hide"),document.querySelector("#ai-or-not_dropzone").classList.remove("hide"),document.querySelector("#hero-home_drop-zone-divider").classList.remove("hide"),document.querySelector("#result-screen_col").classList.add("hide"),document.querySelector("#result-screen_image-wrapper").classList.add("hide"),x.classList.add("hide"),C.classList.remove("hide"),R.classList.remove("hide")},K=()=>{le(),x.src="",de(),P.textContent="Something went wrong. Try again.",document.querySelector("#choose-file-row").classList.remove("hide"),document.querySelector("#legal-tip").classList.add("hide"),document.querySelector(".processing-screen_triggers_5").click(),document.querySelector("#processing-screen").classList.remove("hide"),document.querySelector(".processing-screen_triggers_1").click(),document.querySelector("#hero-home_title-description").classList.add("hide"),document.querySelector("#hero-home_gallery").classList.add("hide"),document.querySelector("#ai-or-not_dropzone").classList.add("hide"),document.querySelector("#hero-home_drop-zone-divider").classList.add("hide"),document.querySelector("#result-screen_col").classList.remove("hide"),document.querySelector("#result-screen_image-wrapper").classList.remove("hide")};function Q(s=!1){s?(R.classList.remove("hide"),x.classList.add("hide"),C.classList.add("hide"),O.classList.add("hide")):(R.classList.add("hide"),x.classList.remove("hide"),C.classList.add("hide"),O.classList.remove("hide")),document.querySelector(".processing-screen_triggers_3").click(),document.querySelector("#processing-screen").classList.add("hide"),document.querySelector(".processing-screen_triggers_5").click(),document.querySelector("#scroll-to-top-trigger").click(),d.value="",document.querySelector("#ai-or-not_image-url").value=""}let X=s=>{s==="unknown"?(document.getElementById("title-human").innerHTML="Sorry, but in this case we can't really say if it's AI or Not",document.getElementById("ai-or-not_result-message-50").classList.remove("hide"),document.getElementById("ai-or-not_result-message").classList.add("hide"),document.getElementById("ai-or-not_result-message-50").innerHTML="Probly the uploaded image has most likely been modified or compressed",document.getElementById("title-human").classList.remove("hide"),document.getElementById("title-ai").classList.add("hide")):(document.getElementById("title-ai").innerHTML='This image is generated by <span class="text-color-green">AI</span>',document.getElementById("title-human").innerHTML='This image is generated by <span class="text-color-green">Human</span>',document.getElementById("ai-or-not_result-message-50").classList.add("hide"),document.getElementById("ai-or-not_result-message").classList.remove("hide"),document.querySelector("#ai-or-not_model-name").textContent=s,s==="ai"?(document.getElementById("title-human").classList.add("hide"),document.getElementById("title-ai").classList.remove("hide")):(document.getElementById("title-human").classList.remove("hide"),document.getElementById("title-ai").classList.add("hide")))},Y=async()=>{if(p.isLimitExceeded()){let s=document.getElementById("sign-up");s.style.display="flex",s.style.zIndex=100,T()}else m.classList.add("hide"),K(),await L.getReportsByUrl(A,N).then(s=>{p.increment(),Z(s.id),x.src=A,X(s.verdict),Q(s.nsfw_detected)}).catch(s=>{H.classList.contains("hide")?J():(J(),T()),console.log(s)})},y=document.body,qe=document.querySelector("#dropzone-fullscreen_message-tip"),we=document.querySelector("#dropzone-fullscreen_message-format");y==null||y.addEventListener("dragover",function(s){s.preventDefault(),document.querySelector(".dropzone-fullscreen").classList.remove("hide")}),y==null||y.addEventListener("dragleave",function(s){s.preventDefault(),document.querySelector(".dropzone-fullscreen").classList.add("hide")}),y==null||y.addEventListener("drop",async function(s){s.preventDefault(),document.querySelector(".dropzone-fullscreen").classList.add("hide");let c=s.dataTransfer.files[0],v=c.size,u=10*1024*1024;v>u?(q=!1,z()):(q=!0,G()),q==!0?await ee(c):z()}),d==null||d.addEventListener("change",async s=>{if(q==!0){let v=document.querySelector("#file-input").files[0];await ee(v)}else z()});let ee=async s=>{if(console.log(s),K(),p.isLimitExceeded()){let u=document.getElementById("sign-up");u.style.display="flex",u.style.zIndex=100,T();return}let c=document.querySelector("#ai-or-not-current-image"),v=URL.createObjectURL(s);c.setAttribute("src",v),x.classList.remove("hide"),C.classList.add("hide"),await L.getReportsByBinary(s,N).then(u=>{p.increment(),Z(u.id),V(),X(u.verdict),Q(u.nsfw_detected)}).catch(u=>{console.log(u),me(),T()})};U==null||U.addEventListener("click",function(){V(),T()}),(te=document.querySelector("#ai-or-not_dropzone"))==null||te.addEventListener("click",function(){W="screen_home",d.click()}),(se=document.querySelector("#choose-file-row"))==null||se.addEventListener("click",function(){W="screen_result",d.click()}),M==null||M.addEventListener("click",()=>{I.value!=""&&(A=I.value,Y())});let j=document.querySelector("#ai-or-not_image-url");j==null||j.addEventListener("keypress",function(s){s.key==="Enter"&&I.value!=""&&(A=I.value,Y())}),g.forEach(s=>{s==null||s.addEventListener("click",()=>{let c=s.getAttribute("test-image-url");document.querySelector("#ai-or-not_image-url").value=c,document.querySelector("#ai-or-not_submit").click(),document.querySelector("#ai-or-not_image-url").value=""})}),r==null||r.addEventListener("click",()=>{ce(),L.sendFeedback($,!0,"")}),n==null||n.addEventListener("click",()=>{}),a==null||a.addEventListener("click",()=>{}),e==null||e.addEventListener("click",()=>{L.sendFeedback($,!1,t.value),ae()}),document==null||document.addEventListener("keydown",function(s){s.code==="Escape"&&o.style.display!=="none"&&a.click()}),t==null||t.addEventListener("change",()=>{t.value!=""?e.classList.remove("is-disabled"):e.classList.add("is-disabled")}),t==null||t.addEventListener("input",()=>{t.value!=""?e.classList.remove("is-disabled"):e.classList.add("is-disabled")})};oe();})();
