"use strict";(()=>{var Ve=Object.create;var we=Object.defineProperty;var $e=Object.getOwnPropertyDescriptor;var Re=Object.getOwnPropertyNames;var Ue=Object.getPrototypeOf,ze=Object.prototype.hasOwnProperty;var Fe=(o=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(o,{get:(e,t)=>(typeof require!="undefined"?require:e)[t]}):o)(function(o){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+o+'" is not supported')});var De=(o,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Re(e))!ze.call(o,n)&&n!==t&&we(o,n,{get:()=>e[n],enumerable:!(s=$e(e,n))||s.enumerable});return o};var je=(o,e,t)=>(t=o!=null?Ve(Ue(o)):{},De(e||!o||!o.__esModule?we(t,"default",{value:o,enumerable:!0}):t,o));var V,Ze=import("https://openfpcdn.io/fingerprintjs/v3").then(o=>o.load()),G=async()=>{V=await Ze.then(o=>o.get()).then(o=>o.visitorId)};function Le(o){var e=o.split(".")[1],t=e.replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(atob(t).split("").map(function(n){return"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(s)}var c="http://localhost:8000",$="https://results.aiornot.com",k=class{constructor(e,t){this.apiUrl=e,this.bearerToken=t}async get(e){let t=`${this.apiUrl}/${e}`;try{let s=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.bearerToken}`}});return await this.handleResponse(s)}catch(s){throw s.status===429&&s.message.msg.type==="requests"&&alert(`It looks like you have reached your plan limit of ${s.message.msg.current_limit} requests. To continue, please upgrade to a new plan.`),console.error("Error",s),s}}async post(e,t){let s=`${this.apiUrl}/${e}`;try{let n=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.bearerToken}`},body:JSON.stringify(t)});return await this.handleResponse(n)}catch(n){throw console.error("Request error",n),n.status===429&&n.message.msg.type==="requests"&&alert(`It looks like you have reached your plan limit of ${n.message.msg.current_limit} requests. To continue, please upgrade to a new plan.`),n}}async postBinary(e,t){let s=`${this.apiUrl}/${e}`;console.log("url",s);try{let n=await fetch(s,{method:"POST",headers:{Accept:"application/json",Authorization:`Bearer ${this.bearerToken}`},body:t});return await this.handleResponse(n)}catch(n){throw console.error("Binary request error:",n),n.status===429&&n.message.msg.type==="requests"&&alert(`It looks like you have reached your plan limit of ${n.message.msg.current_limit} requests. To continue, please upgrade to a new plan.`),n}}async delete(e){let t=`${this.apiUrl}/${e}`;try{let s=await fetch(t,{method:"DELETE",headers:{accept:"*/*",Authorization:`Bearer ${this.bearerToken}`}});await this.handleResponse(s)}catch(s){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0438 DELETE-\u0437\u0430\u043F\u0440\u043E\u0441\u0430:",s),s}}async patch(e,t){let s=`${this.apiUrl}/${e}`;try{let n=await fetch(s,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.bearerToken}`},body:JSON.stringify(t)});return await this.handleResponse(n)}catch(n){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0438 PATCH-\u0437\u0430\u043F\u0440\u043E\u0441\u0430:",n),n}}async handleResponse(e){if(!e.ok){let t=await e.json();throw{status:e.status,message:t}}if(e.status!==204)return await e.json()}};var m=class{constructor(){let e=a.getToken(),t=`${c}/aion/users`;this.client=new k(t,e)}static getInstance(){return m.instance||(m.instance=new m),m.instance}static async fetchRequests(e=0,t=10){try{let{client:s}=m.getInstance(),n=`data?filters=requests&offset=${e}&limit=${t}`;return await s.get(n).then(i=>i.requests.array)}catch(s){return console.error("getRequests:",s),[]}}static async fetchUsageApi(){try{let{client:e}=m.getInstance(),t="data?filters=all&offset=0&limit=1";return await e.get(t).then(s=>s.api)}catch(e){return console.error("fetchUsageApi:",e),[]}}static async signUp(){try{let{client:e}=m.getInstance();return await e.post("sign_up",{}).then(()=>!1).catch(t=>{if(t.status===400)return!0;throw t})}catch(e){return console.error("signUp:",e),!1}}static async login(){try{let{client:e}=m.getInstance();return await e.get("login")}catch(e){console.error("login:",e)}}static async delete(){try{let{client:e}=m.getInstance();return await e.delete("")}catch(e){console.error("delete:",e)}}static async fetchApiToken(){try{let{client:e}=m.getInstance();return await e.post("api_token",{})}catch(e){console.error("fetchApiToken:",e),console.error("fetchApiToken:",e)}}static async refreshApiToken(){try{let{client:e}=m.getInstance();return await e.patch("api_token",{})}catch(e){console.error("refreshApiToken:",e)}}static async fetchSubscriptionData(){let{client:e}=m.getInstance();try{let t="data?filters=all&offset=0&limit=1";return await e.get(t).then(s=>s)}catch(t){console.error("fetchSubscriptionData:",t)}}},h=m;h.instance=null;var L=class{constructor(){}static isAuth(){return localStorage.getItem(L.key)!==null}static setAuth(){localStorage.setItem(L.key,"true")}static removeAuth(){localStorage.removeItem(L.key)}static async init(){L.isAuth()?await h.login():(await h.signUp(),L.setAuth(),await h.login())}static getToken(){var e;return(e=localStorage.getItem("_ms-mid"))!=null?e:""}static isExpiredToken(){let e=L.getToken();if((e==null?void 0:e.length)>0){let t=Le(e),s=Date.now()/1e3;return t.exp<s}return!0}},a=L;a.key="isSignUp";var y=class{constructor(){let e=a.getToken(),t=`${c}/aion/ai-generated`;this.client=new k(t,e)}static getInstance(){return y.instance||(y.instance=new y),y.instance}static async getReportsByBinary(e){let{client:t}=y.getInstance();try{let s=new FormData;return s.append("binary",e,"uploaded-file.png"),await t.postBinary("reports/binary",s)}catch(s){s.status===402&&alert("Please verify your email to continue using the service"),s.status===429&&alert(`You have reached the limit of requests per day. Alert: ${JSON.stringify(s.message)}`),console.error("Error getReportsByBinary:",s)}}static async getReportsByUrl(e){let{client:t}=y.getInstance();try{let s=`reports/url?url=${e}`;return await t.post(s,{})}catch(s){s.status===402&&alert("Please verify your email to continue using the service"),console.error("getReportsByUrl:",s)}}static async getAudioVerdict(e){console.log("getAudioVerdict");let{client:t}=y.getInstance();try{let s=new FormData;return s.append("file",e),await t.postBinary("reports/audio/binary",s)}catch(s){s.status===402&&alert("Please verify your email to continue using the service"),console.error("Error getAudioVerdict:",s)}}static async getYoutubeVerdict(e){let{client:t}=y.getInstance();try{let s={url:e};return await t.post("reports/audio/link",s)}catch(s){s.status===402&&alert("Please verify your email to continue using the service"),console.error("Error getYoutubeVerdict:",s)}}},S=y;S.instance=null;var x=class{constructor(){}static async getReportsByBinary(e,t){let s=`${c}/results/api/detector/reports/raw?source=web&user_id=${t}`,n=new FormData;n.append("binary",e,"file_name.png");let i={method:"POST",headers:{Accept:"application/json",Authorization:`Bearer ${a.getToken()}`},body:n};return await fetch(s,i).then(u=>u.json())}static async getReportsByUrl(e,t){let s=`${c}/results/api/detector/reports/json?source=web&user_id=${t}`,n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${a.getToken()}`},body:JSON.stringify({object:e})};return await fetch(s,n).then(i=>i.json())}static async sendFeedback(e,t,s,n=!1){let i={is_proper_predict:t,comment:s},u=`${c}/results/api/detector/reports/result/${e}`,C={method:"PUT",body:JSON.stringify(i),headers:{Accept:"application/json","Content-Type":"application/json"}};(n||!a.isExpiredToken())&&(u=`${c}/aion/ai-generated/reports/${e}`,C={method:"PATCH",body:JSON.stringify(i),headers:{Accept:"application/json","Content-Type":"application/json"}}),await fetch(u,C).then(b=>b.json()).then(b=>console.log(b)).catch(b=>console.error(b))}static async getAudioVerdict(e){let t=`${c}/aion/ai-generated/reports/audio/binary`,s=new FormData;return s.append("file",e),await fetch(t,{method:"POST",headers:{Accept:"application/json",ContentType:"multipart/form-data"},body:s}).then(i=>i.json())}static async getYoutubeVerdict(e){let t=`${c}/aion/ai-generated/reports/audio/link`,s={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({url:e})};return await fetch(t,s).then(n=>n.json())}};var R=class{constructor(){}static isLimitExceeded(){return!!a.isExpiredToken()}static increment(){let e=localStorage.getItem(R.key),t=e===null?1:Number(e)+1;localStorage.setItem(R.key,t.toString())}},v=R;v.key="requestCount";var E=class{static async getReportsByBinary(e,t){return a.isExpiredToken()?await x.getReportsByBinary(e,t):await S.getReportsByBinary(e)}static async getReportsByUrl(e,t){return a.isExpiredToken()?await x.getReportsByUrl(e,t):await S.getReportsByUrl(e)}static async getAudioVerictByFile(e){return await S.getAudioVerdict(e)}static async getAudioVerictMock(e){let s=await((n,i)=>new Promise(u=>{setTimeout(()=>{u(i)},n)}))(1500,e);return JSON.parse(`{
            "id": "41994fdd-0161-43a9-b873-581eccbe6d72",
            "report": {
                "version": "0.0.0",
                "verdict": ${s}
            }
        }`)}static async getYoutubeVerict(e){return a.isExpiredToken()?await x.getYoutubeVerdict(e):await S.getYoutubeVerdict(e)}static async sendFeedback(e,t,s,n=!1){return await x.sendFeedback(e,t,s,n)}};var J=document.querySelector("#contact-us-submit-button"),Oe=document.querySelector("#name"),Ne=document.querySelector("#E-Mail"),Ye=document.querySelector("#Note"),We=document.querySelector("#Company");J&&(J.classList.remove("is-disabled"),J.addEventListener("click",async o=>{o.preventDefault();let e={name:Oe.value,email:Ne.value,note:Ye.value,company:We.value};for(let t in e)if(t!=="company"&&e[t]===""){alert(`Please fill in all required fields ${t}`);return}console.log(e),fetch(`${c}/aion/system/post_message`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(t=>{t.ok?(alert("Thank you for your application! We will contact you shortly."),window.location.href="https://aiornot.webflow.io/"):alert("Something went wrong. Please try again.")})}));var Se=()=>{var fe,ve;let o=document.getElementById("image-tab"),e=document.getElementById("audio-tab"),t=document.getElementById("report-screen"),s=document.querySelector("#button-report-submit"),n=document.querySelector("#input-report-comment"),i=document.querySelector("#button-report_true"),u=document.querySelector("#button-report_false"),C=document.querySelector("#button-report_close"),b=document.querySelectorAll(".test-image"),_=document.querySelector("#url-error-message"),D=document.querySelector("#processing_cancel"),p=document.querySelector("#file-input"),T=document.querySelector("#ai-or-not-current-image"),I=document.querySelector("#empty-preview-img"),j=document.querySelector("#nsfw-preview-img"),Z=document.querySelector("#input-error-text"),P=document.querySelector("#ai-or-not_image-url"),O=document.querySelector("#image-url-aion-submit"),se=document.querySelector("#ai-or-not_dropzone"),w=document.querySelector("#ai-or-not_dropzone-text"),ne=document.querySelector("#result-screen_col"),re=document.querySelector("#share-items-hide"),qe=document.querySelector("#ai-or-not-dropzone-counter"),A=document.querySelector("#ai-or-not-dropzone-counter-w");document.querySelector("#w-node-_80502d56-29f7-2965-16f1-d6c6c4ebbd86-c4ebbd86").classList.add("hide"),re.classList.add("hide");function ke(){return o.classList.contains("w--current")?"image":"audio"}let M,oe,q,N;(()=>{if(!a.isExpiredToken())A==null||A.classList.add("hide");else{let r=localStorage.getItem("requestCount")||"0";qe.textContent=Number(r)<=5?r:"5",A.classList.remove("hide")}})(),G();let _e=()=>{let r=document.querySelector("#button-report_false-text");r.classList.remove("hide"),r.textContent=r.getAttribute("report-button-text-default_reported"),u.classList.add("is-reported"),i.classList.add("hide")},Be=()=>{let r=document.querySelector("#button-report_true-text");r.classList.remove("hide"),r.textContent=r.getAttribute("report-button-text-default_reported"),i.classList.add("is-reported"),u.classList.add("hide")},Ie=()=>{n.value="";let r=document.querySelector("#button-report_true-text"),l=document.querySelector("#button-report_false-text");l.classList.add("hide"),r.classList.remove("hide"),r.textContent=r.getAttribute("report-button-text-default"),l.textContent=l.getAttribute("report-button-text-default"),i.classList.remove("is-reported"),u.classList.remove("is-reported"),i.classList.remove("hide"),u.classList.remove("hide")},ie=r=>{N=r;let l=document.querySelector('[fs-socialshare-element="url"]'),d=`${a.isExpiredToken()?`${$}/aiornot/`:`${$}/aiornot/users/`}${r}`;l.textContent=d,document.querySelectorAll(".result-screen_share-item").forEach(He=>{He.setAttribute("data-url",d)})},ae=()=>{w.textContent="We support jpeg, png, webp, gif, tiff, bmp. 10 Mb of maximum size.",w.classList.remove("text-color-red"),Z.textContent="Something went wrong. Try again.",_.classList.add("hide")},le=()=>{_.classList.remove("hide")},Pe=()=>{_.classList.add("hide")},H=()=>{ne.classList.contains("hide")?(w.textContent="File is too large (max 10 MB)",w.classList.add("text-color-red")):(Z.textContent="File is too large (max 10 MB)",_.classList.remove("hide"))};p==null||p.addEventListener("change",()=>{let r=p==null?void 0:p.files[0].size,l=10*1024*1024;r>l?(q=!1,H()):(q=!0,ae())});let Ae=()=>{document.querySelector("#processing-screen").classList.add("hide"),w.classList.add("error"),se.classList.add("red-border"),w.textContent="Something went wrong. Try again."},ce=()=>{w.classList.remove("error"),se.classList.remove("red-border"),w.textContent="We support jpeg, png, webp, gif, tiff, bmp. 10 Mb of maximum size."},B=()=>{document.querySelector("#choose-file-row").classList.add("hide"),document.querySelector("#legal-tip").classList.remove("hide"),document.querySelector("#processing-screen").classList.add("hide"),document.querySelector("#hero-home_title-description").classList.remove("hide"),document.querySelector("#hero-home_gallery").classList.remove("hide"),document.querySelector("#ai-or-not_dropzone").classList.remove("hide"),document.querySelector("#hero-home_drop-zone-divider").classList.remove("hide"),document.querySelector("#result-screen_col").classList.add("hide"),document.querySelector("#result-screen_image-wrapper").classList.add("hide"),T.classList.add("hide"),I.classList.remove("hide"),j.classList.remove("hide")},de=()=>{Ie(),T.src="",Pe(),Z.textContent="Something went wrong. Try again.",document.querySelector("#choose-file-row").classList.remove("hide"),document.querySelector("#legal-tip").classList.add("hide"),document.querySelector(".processing-screen_triggers_5").click(),document.querySelector("#processing-screen").classList.remove("hide"),document.querySelector(".processing-screen_triggers_1").click(),document.querySelector("#hero-home_title-description").classList.add("hide"),document.querySelector("#hero-home_gallery").classList.add("hide"),document.querySelector("#ai-or-not_dropzone").classList.add("hide"),document.querySelector("#hero-home_drop-zone-divider").classList.add("hide"),document.querySelector("#result-screen_col").classList.remove("hide"),document.querySelector("#result-screen_image-wrapper").classList.remove("hide")};function ue(r=!1){r?(j.classList.remove("hide"),T.classList.add("hide"),I.classList.add("hide"),re.classList.add("hide")):(j.classList.add("hide"),T.classList.remove("hide"),I.classList.add("hide")),document.querySelector(".processing-screen_triggers_3").click(),document.querySelector("#processing-screen").classList.add("hide"),document.querySelector(".processing-screen_triggers_5").click(),p.value="",document.querySelector("#ai-or-not_image-url").value=""}let me=r=>{r==="unknown"?(document.getElementById("title-human").innerHTML="Sorry, but in this case we can't really say if it's AI or Not",document.getElementById("ai-or-not_result-message-50").classList.remove("hide"),document.getElementById("ai-or-not_result-message").classList.add("hide"),document.getElementById("ai-or-not_result-message-50").innerHTML="Probly the uploaded image has most likely been modified or compressed",document.getElementById("title-human").classList.remove("hide"),document.getElementById("title-ai").classList.add("hide")):(document.getElementById("title-ai").innerHTML=`This is likely <span class="text-color-green">AI</span> <div style="font-size: 1rem; color: #FFFFFFB3; font-family: Space Grotesk, sans-serif;">
<span> Free Research Preview. AI or Not may produce inaccurate results </span>
</div>`,document.getElementById("title-human").innerHTML=`This is likely <span class="text-color-green">Human</span><div style="font-size: 1rem; color: #FFFFFFB3; font-family: Space Grotesk, sans-serif;">
<span> Free Research Preview. AI or Not may produce inaccurate results </span>
</div>`,document.getElementById("ai-or-not_result-message-50").classList.add("hide"),document.getElementById("ai-or-not_result-message").classList.remove("hide"),document.querySelector("#ai-or-not_model-name").textContent=r,r==="ai"?(document.getElementById("title-human").classList.add("hide"),document.getElementById("title-ai").classList.remove("hide")):(document.getElementById("title-human").classList.remove("hide"),document.getElementById("title-ai").classList.add("hide")))},pe=async()=>{if(v.isLimitExceeded()){let r=document.getElementById("sign-up");r.style.display="flex",r.style.zIndex=100,B()}else _.classList.add("hide"),de(),await E.getReportsByUrl(M,V).then(r=>{v.increment(),ie(r.id),T.src=M,me(r.verdict),ue(r.nsfw_detected)}).catch(r=>{ne.classList.contains("hide")?le():(le(),B()),console.log(r)})},g=document.body,ot=document.querySelector("#dropzone-fullscreen_message-tip"),it=document.querySelector("#dropzone-fullscreen_message-format");g==null||g.addEventListener("dragover",function(r){r.preventDefault(),document.querySelector(".dropzone-fullscreen").classList.remove("hide")}),g==null||g.addEventListener("dragleave",function(r){r.preventDefault(),document.querySelector(".dropzone-fullscreen").classList.add("hide")}),g==null||g.addEventListener("drop",async function(r){if(ke()!=="image")return;console.log("Image handler"),r.preventDefault(),document.querySelector(".dropzone-fullscreen").classList.add("hide");let l=r.dataTransfer.files[0],f=l.size,d=10*1024*1024;f>d?(q=!1,H()):(q=!0,ae()),q==!0?await he(l):H()}),p==null||p.addEventListener("change",async r=>{if(q==!0){let f=document.querySelector("#file-input").files[0];await he(f)}else H()});let he=async r=>{if(console.log(r),de(),v.isLimitExceeded()){let d=document.getElementById("sign-up");d.style.display="flex",d.style.zIndex=100,B();return}let l=document.querySelector("#ai-or-not-current-image"),f=URL.createObjectURL(r);l.setAttribute("src",f),T.classList.remove("hide"),I.classList.add("hide"),await E.getReportsByBinary(r,V).then(d=>{v.increment(),ie(d.id),ce(),me(d.verdict),ue(d.nsfw_detected)}).catch(d=>{console.log(d),Ae(),B()})};D==null||D.addEventListener("click",function(){ce(),B()}),(fe=document.querySelector("#ai-or-not_dropzone"))==null||fe.addEventListener("click",function(){oe="screen_home",p.click()}),(ve=document.querySelector("#choose-file-row"))==null||ve.addEventListener("click",function(){oe="screen_result",p.click()}),O==null||O.addEventListener("click",()=>{P.value!=""&&(M=P.value,pe())});let Y=document.querySelector("#ai-or-not_image-url");Y==null||Y.addEventListener("keypress",function(r){r.key==="Enter"&&P.value!=""&&(M=P.value,pe())}),b.forEach(r=>{r==null||r.addEventListener("click",()=>{let l=r.getAttribute("test-image-url");document.querySelector("#ai-or-not_image-url").value=l,document.querySelector("#image-url-aion-submit").click(),document.querySelector("#ai-or-not_image-url").value=""})}),i==null||i.addEventListener("click",()=>{Be(),E.sendFeedback(N,!0,"")}),u==null||u.addEventListener("click",()=>{}),C==null||C.addEventListener("click",()=>{}),s==null||s.addEventListener("click",()=>{E.sendFeedback(N,!1,n.value),_e()}),document==null||document.addEventListener("keydown",function(r){r.code==="Escape"&&t.style.display!=="none"&&C.click()}),n==null||n.addEventListener("change",()=>{n.value!=""?s.classList.remove("is-disabled"):s.classList.add("is-disabled")}),n==null||n.addEventListener("input",()=>{n.value!=""?s.classList.remove("is-disabled"):s.classList.add("is-disabled")});let ye=document.querySelector("#ai-or-not_image-url"),ge=document.querySelector("#image-url-aion-submit");ye.addEventListener("input",function(){let r=ye.value.trim();Me(r)?ge.classList.remove("is-disabled"):ge.classList.add("is-disabled")});let Me=r=>{try{return new URL(r),!0}catch{return!1}},W=document.getElementById("close-sign-up");W==null||W.addEventListener("click",()=>{let r=document.getElementById("sign-up");r.style.display="none",r.style.zIndex=0}),h.fetchSubscriptionData().then(r=>{var f;let l=document.querySelector("#image-quotas");if(console.log(r),r){let{quantity:d}=((f=r.plan)==null?void 0:f.requests_limits)||{quantity:20},{total:Ee}=r.requests;l.innerHTML=`
            <div style="margin-top: 20px; font-size: 1rem; color: white">
            <span">
                Available ${d-Ee} from ${d} requests 
            </span>
            </div>`}else l.textContent="Available 20 requests / 24 hours"})};var be="https://js.stripe.com/v3",Ge=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,Ce="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",Je=function(){for(var e=document.querySelectorAll('script[src^="'.concat(be,'"]')),t=0;t<e.length;t++){var s=e[t];if(Ge.test(s.src))return s}return null},Xe=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",s=document.createElement("script");s.src="".concat(be).concat(t);var n=document.head||document.body;if(!n)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return n.appendChild(s),s},Ke=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"2.1.7",startTime:t})},U=null,Qe=function(e){return U!==null||(U=new Promise(function(t,s){if(typeof window=="undefined"||typeof document=="undefined"){t(null);return}if(window.Stripe&&e&&console.warn(Ce),window.Stripe){t(window.Stripe);return}try{var n=Je();n&&e?console.warn(Ce):n||(n=Xe(e)),n.addEventListener("load",function(){window.Stripe?t(window.Stripe):s(new Error("Stripe.js not available"))}),n.addEventListener("error",function(){s(new Error("Failed to load Stripe.js"))})}catch(i){s(i);return}})),U},et=function(e,t,s){if(e===null)return null;var n=e.apply(void 0,t);return Ke(n,s),n},xe=Promise.resolve().then(function(){return Qe(null)}),Te=!1;xe.catch(function(o){Te||console.warn(o)});var X=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];Te=!0;var n=Date.now();return xe.then(function(i){return et(i,t,n)})};var z=class{constructor(){this.elements=null;this.stripe=null;this.home_element=document.querySelector("#home")}createPaymentForm(e){this.home_element.innerHTML=`
        <div style="background: white; position: fixed; top: 0; left: 0; right: 0; bottom: 0; display: flex; flex-direction: column; justify-content: center; align-items: center">
           <div class="payment-container">
           <div class="sr-root" style="display: flex; flex-direction: row; align-items: center; justify-content: center; min-width: 380px">
            <div class="sr-main">
                <h2 style="color: black; font-size: 2.5rem; justify-content: center">${e}</h2>
                <br>
                <form id="payment-form" style="min-width: 380px">
                    <div id="payment-element"></div>
                    <br>
                    // Add callback function
                    <button class="button" style="width: 100%" id="submit">
                        <div class="spinner hidden" id="spinner"></div>
                        <span style="width: 100 %;" id="button-text">Pay</span>
                    </button>
                </form>
            </div>
        </div>
        </div>
        </div>
    `,document.querySelector("#submit").addEventListener("click",()=>{console.log("test"),this.completePayment()})}async createPaymentIntent(e){fetch(`${c}/aion/payments/config`).then(t=>t.json()).then(t=>{X(t.stripe_public_key).then(s=>{this.stripe=s,fetch(`${c}/aion/payments/create_intent`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.checkUserToken()}`},body:JSON.stringify({product_id:e})}).then(n=>n.json()).then(n=>{if(n.code===10)throw console.warn(n.message),alert(n.message),window.location.href=`https://${window.location.host}/`,new Error(n.message);this.elements=this.stripe.elements({clientSecret:n.client_secret}),this.elements.create("payment").mount("#payment-element")})})})}paymentCheckoutSession(e){fetch(`${c}/aion/payments/checkout_session`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.checkUserToken()}`},body:JSON.stringify({product_id:e,quantity:1,success_redirect_url:"https://aiornot.webflow.io/dashboard/history",cancel_redirect_url:"https://aiornot.webflow.io/new-home#pricing"})}).then(t=>t.json()).then(t=>{if(console.log(t),t.code===10)throw console.warn(t.message),alert(t.message),new Error(t.message);X(t.checkout_public_key).then(s=>{if(!s){console.error("Something wrong when create a Stripe object");return}s.redirectToCheckout({sessionId:t.checkout_session_id})})}).catch(t=>{console.error("Something wrong when create a checkout session",t)})}checkUserToken(){let e=localStorage.getItem("_ms-mid");if(!e)throw new Error("User token not found");return e}completePayment(){console.log("completePayment"),console.log(this.elements),this.stripe.confirmPayment({elements:this.elements,confirmParams:{return_url:`https://${window.location.host}/dashboard/history`}}).then(e=>{e.error?(console.error(e.error.message),alert(e.error.message)):console.log(e)})}};var K=document.querySelector("#bt-pay-free"),Q=document.querySelector("#bt-pay-basic"),ee=document.querySelector("#bt-pay-pro"),te=document.querySelector("#bt-pay-enterprice"),tt="price_1O2Ba4Ba9yG4sk8k4y3ZnEVT",st="price_1O2BZtBa9yG4sk8kGov7oQ8u",F=new z;K==null||K.addEventListener("click",()=>{window.location.href=`https://${window.location.host}/signup`});Q==null||Q.addEventListener("click",()=>{F.createPaymentForm("Basic plan: 30$/month"),F.createPaymentIntent(tt)});ee==null||ee.addEventListener("click",()=>{console.log("buttonPayProPlan"),F.createPaymentForm("Pro plan: 100$/month"),F.createPaymentIntent(st)});te==null||te.addEventListener("click",()=>{window.location.href=`https://${window.location.host}/contact-us`});Se();})();
