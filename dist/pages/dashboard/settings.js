"use strict";(()=>{function m(g){var t=g.split(".")[1],r=t.replace(/-/g,"+").replace(/_/g,"/"),e=decodeURIComponent(atob(r).split("").map(function(n){return"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)}var p="https://v3-atrium-prod-api.optic.xyz";var l=class{constructor(t,r){this.apiUrl=t,this.bearerToken=r}async get(t){let r=`${this.apiUrl}/${t}`;try{let e=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.bearerToken}`}});return await this.handleResponse(e)}catch(e){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0438 GET-\u0437\u0430\u043F\u0440\u043E\u0441\u0430:",e),e}}async post(t,r){let e=`${this.apiUrl}/${t}`;try{let n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.bearerToken}`},body:JSON.stringify(r)});return await this.handleResponse(n)}catch(n){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0438 POST-\u0437\u0430\u043F\u0440\u043E\u0441\u0430:",n),n}}async postBinary(t,r){let e=`${this.apiUrl}/${t}`;try{let n=await fetch(e,{method:"POST",headers:{Accept:"application/json",Authorization:`Bearer ${this.bearerToken}`},body:r});return await this.handleResponse(n)}catch(n){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0438 POST-\u0437\u0430\u043F\u0440\u043E\u0441\u0430:",n),n}}async delete(t){let r=`${this.apiUrl}/${t}`;try{let e=await fetch(r,{method:"DELETE",headers:{accept:"*/*",Authorization:`Bearer ${this.bearerToken}`}});await this.handleResponse(e)}catch(e){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0438 DELETE-\u0437\u0430\u043F\u0440\u043E\u0441\u0430:",e),e}}async patch(t,r){let e=`${this.apiUrl}/${t}`;try{let n=await fetch(e,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.bearerToken}`},body:JSON.stringify(r)});return await this.handleResponse(n)}catch(n){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0438 PATCH-\u0437\u0430\u043F\u0440\u043E\u0441\u0430:",n),n}}async handleResponse(t){if(!t.ok){let r=await t.json();throw{status:t.status,message:r}}if(t.status!==204)return await t.json()}};var i=class{constructor(){let t=o.getToken(),r=`${p}/aion/users`;this.client=new l(r,t)}static getInstance(){return i.instance||(i.instance=new i),i.instance}static async fetchRequests(t=0,r=10){try{let e=i.getInstance().client,n=`data?filters=requests&offset=${t}&limit=${r}`;return await e.get(n).then(h=>h.requests.array)}catch(e){return console.error("\u041E\u0448\u0438\u0431\u043A\u0430 getRequests:",e),[]}}static async fetchUsageApi(){try{let t=i.getInstance().client,r="data?filters=api&offset=0&limit=10";return await t.get(r).then(e=>e.api)}catch(t){return console.error("\u041E\u0448\u0438\u0431\u043A\u0430 fetchUsageApi:",t),[]}}static async signUp(){try{return await i.getInstance().client.post("sign_up",{}).then(()=>!1).catch(r=>{if(r.status===400)return!0;throw r})}catch(t){return console.error("\u041E\u0448\u0438\u0431\u043A\u0430 signUp:",t),!1}}static async login(){try{return await i.getInstance().client.get("login")}catch(t){console.error("\u041E\u0448\u0438\u0431\u043A\u0430 login:",t)}}static async delete(){try{return await i.getInstance().client.delete("")}catch(t){console.error("\u041E\u0448\u0438\u0431\u043A\u0430 delete:",t)}}static async fetchApiToken(){try{return await i.getInstance().client.post("api_token",{})}catch(t){console.error("\u041E\u0448\u0438\u0431\u043A\u0430 fetchApiToken:",t)}}static async refreshApiToken(){try{return await i.getInstance().client.patch("api_token",{})}catch(t){console.error("\u041E\u0448\u0438\u0431\u043A\u0430 refreshApiToken:",t)}}},s=i;s.instance=null;var c=class{constructor(){}static isAuth(){return localStorage.getItem(c.key)!==null}static setAuth(){localStorage.setItem(c.key,"true")}static removeAuth(){localStorage.removeItem(c.key)}static async init(){c.isAuth()?await s.login():(await s.signUp(),c.setAuth(),await s.login())}static getToken(){var t;return(t=localStorage.getItem("_ms-mid"))!=null?t:""}static isExpiredToken(){let t=c.getToken();if((t==null?void 0:t.length)>0){let r=m(t),e=Date.now()/1e3;return r.exp<e}return!0}},o=c;o.key="isSignUp";var a=class{constructor(){let t=o.getToken(),r=`${p}/aion/ai-generated`;this.client=new l(r,t)}static getInstance(){return a.instance||(a.instance=new a),a.instance}static async getReportsByBinary(t){let r=a.getInstance().client;try{let e=new FormData;return e.append("binary",t,"uploaded-file.png"),await r.postBinary("reports/binary",e)}catch(e){console.error("Error getReportsByBinary:",e)}}static async getReportsByUrl(t){let r=a.getInstance().client;try{let e=`reports/url?url=${t}`;return await r.post(e,{})}catch(e){console.error("\u041E\u0448\u0438\u0431\u043A\u0430 getReportsByUrl:",e)}}static async getAudioVerdict(t){let r=a.getInstance().client;try{let e=new FormData;return e.append("file",t),await r.postBinary("reports/audio/binary",e)}catch(e){console.error("Error getAudioVerdict:",e)}}static async getYoutubeVerdict(t){let r=a.getInstance().client;try{let e={url:t};return await r.post("reports/audio/link",e)}catch(e){console.error("Error getYoutubeVerdict:",e)}}},u=a;u.instance=null;var d=class{constructor(){}static isLimitExceeded(){return!!o.isExpiredToken()}static increment(){let t=localStorage.getItem(d.key),r=t===null?1:Number(t)+1;localStorage.setItem(d.key,r.toString())}},y=d;y.key="requestCount";document.getElementById("delete-account").onclick=async()=>{await o.init(),await s.delete(),window.location.href="https://aiornot.com"};document.getElementById("sign-out").onclick=()=>{o.removeAuth()};})();
