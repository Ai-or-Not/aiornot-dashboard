"use strict";(()=>{var p=class{constructor(t,e){this.apiUrl=t,this.bearerToken=e}async get(t){let e=`${this.apiUrl}/${t}`;try{let r=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.bearerToken}`}});return await this.handleResponse(r)}catch(r){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0438 GET-\u0437\u0430\u043F\u0440\u043E\u0441\u0430:",r),r}}async post(t,e){let r=`${this.apiUrl}/${t}`;try{let o=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.bearerToken}`},body:JSON.stringify(e)});return await this.handleResponse(o)}catch(o){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0438 POST-\u0437\u0430\u043F\u0440\u043E\u0441\u0430:",o),o}}async postBinary(t,e){let r=`${this.apiUrl}/${t}`;try{let o=await fetch(r,{method:"POST",headers:{Accept:"application/json",Authorization:`Bearer ${this.bearerToken}`},body:e});return await this.handleResponse(o)}catch(o){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0438 POST-\u0437\u0430\u043F\u0440\u043E\u0441\u0430:",o),o}}async delete(t){let e=`${this.apiUrl}/${t}`;try{let r=await fetch(e,{method:"DELETE",headers:{accept:"*/*",Authorization:`Bearer ${this.bearerToken}`}});await this.handleResponse(r)}catch(r){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0438 DELETE-\u0437\u0430\u043F\u0440\u043E\u0441\u0430:",r),r}}async patch(t,e){let r=`${this.apiUrl}/${t}`;try{let o=await fetch(r,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.bearerToken}`},body:JSON.stringify(e)});return await this.handleResponse(o)}catch(o){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0438 PATCH-\u0437\u0430\u043F\u0440\u043E\u0441\u0430:",o),o}}async handleResponse(t){if(!t.ok){let e=await t.json();throw{status:t.status,message:e}}if(t.status!==204)return await t.json()}};var a=class{constructor(){let t=n.getToken(),e="https://atrium-prod-api.optic.xyz/aion/users";this.client=new p(e,t)}static getInstance(){return a.instance||(a.instance=new a),a.instance}static async fetchRequests(t=0,e=10){try{let r=a.getInstance().client,o=`data?filters=requests&offset=${t}&limit=${e}`;return await r.get(o).then(h=>h.requests.array)}catch(r){return console.error("\u041E\u0448\u0438\u0431\u043A\u0430 getRequests:",r),[]}}static async fetchUsageApi(){try{let t=a.getInstance().client,e="data?filters=api&offset=0&limit=10";return await t.get(e).then(r=>r.api)}catch(t){return console.error("\u041E\u0448\u0438\u0431\u043A\u0430 fetchUsageApi:",t),[]}}static async signUp(){try{return await a.getInstance().client.post("sign_up",{}).then(()=>!1).catch(e=>{if(e.status===400)return!0;throw e})}catch(t){return console.error("\u041E\u0448\u0438\u0431\u043A\u0430 signUp:",t),!1}}static async login(){try{return await a.getInstance().client.get("login")}catch(t){console.error("\u041E\u0448\u0438\u0431\u043A\u0430 login:",t)}}static async delete(){try{return await a.getInstance().client.delete("")}catch(t){console.error("\u041E\u0448\u0438\u0431\u043A\u0430 delete:",t)}}static async fetchApiToken(){try{return await a.getInstance().client.post("api_token",{})}catch(t){console.error("\u041E\u0448\u0438\u0431\u043A\u0430 fetchApiToken:",t)}}static async refreshApiToken(){try{return await a.getInstance().client.patch("api_token",{})}catch(t){console.error("\u041E\u0448\u0438\u0431\u043A\u0430 refreshApiToken:",t)}}},i=a;i.instance=null;var s=class{constructor(){}static isAuth(){return localStorage.getItem(s.key)!==null}static setAuth(){localStorage.setItem(s.key,"true")}static removeAuth(){localStorage.removeItem(s.key)}static async init(){s.isAuth()?await i.login():(await i.signUp(),s.setAuth(),await i.login())}static getToken(){var t;return(t=localStorage.getItem("_ms-mid"))!=null?t:""}static isExpiredToken(){let t=s.getToken();try{let[e,r,o]=t.split("."),h=JSON.parse(atob(r)),m=Math.floor(Date.now()/1e3);return h.exp<m}catch(e){return console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u043F\u0440\u043E\u0432\u0435\u0440\u043A\u0435 \u0442\u043E\u043A\u0435\u043D\u0430:",e),!1}}},n=s;n.key="isSignUp";var c=class{constructor(){let t=n.getToken(),e="https://atrium-prod-api.optic.xyz/aion/ai-generated";this.client=new p(e,t)}static getInstance(){return c.instance||(c.instance=new c),c.instance}static async getReportsByBinary(t){let e=c.getInstance().client;try{let r=new FormData;return r.append("binary",t,"uploaded-file.png"),await e.postBinary("reports/binary",r)}catch(r){console.error("Error getReportsByBinary:",r)}}static async getReportsByUrl(t){let e=c.getInstance().client;try{let r=`reports/url?url=${t}`;return await e.post(r,{})}catch(r){console.error("\u041E\u0448\u0438\u0431\u043A\u0430 getReportsByUrl:",r)}}},u=c;u.instance=null;var l=class{constructor(){}static isLimitExceeded(){if(!n.isExpiredToken())return!1;let t=localStorage.getItem(l.key);return t===null?!1:parseInt(t)>5}static increment(){let t=localStorage.getItem(l.key),e=t===null?1:Number(t)+1;localStorage.setItem(l.key,e.toString())}},y=l;y.key="requestCount";document.getElementById("delete-account").onclick=async()=>{await n.init(),await i.delete(),window.location.href="https://aiornot.com"};document.getElementById("sign-out").onclick=()=>{n.removeAuth()};})();
